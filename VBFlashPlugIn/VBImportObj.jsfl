function sliceFileType(_fileName) {	var _result = "";	var _add = false;	for(var _i = _fileName.length - 1; _i >= 0; _i--) {		if(_add)			_result = _fileName[_i] + _result;		if(_fileName[_i] == '.') {			_add = true;		}	}	return _result;}function main() {	var pathname = "";	pathname = FlashCS5extension.GetProjectPathAndFileName();		var doc_name = FLfile.platformPathToURI(pathname + ".fla");	var isExisting = fl.fileExists(doc_name);		var doc;	if(isExisting) {		doc = fl.openDocument(doc_name);	} else {		doc = fl.createDocument();		fl.saveDocument(doc, doc_name);	}		var pngPath = sliceFileType(doc.pathURI) + "_slice";	var folderContents = FLfile.listFolder(pngPath, "files");	var lib = doc.library;	for(var i = 0; i < lib.items.length; i++) {		if(lib.items[i].itemType != "bitmap")			continue;		var isExistItem = false;		for(var j = 0; j < folderContents.length; j++) {			if(".DS_Store" == folderContents[j])				continue;			if(lib.items[i].sourceFilePath == FLfile.platformPathToURI(FLfile.uriToPlatformPath(pngPath + "/" + folderContents[j]))) {				isExistItem = true;				break;			}		}		if(isExistItem == false) {			doc.library.deleteItem(lib.items[i].name);		}	}	for(var i = 0; i < folderContents.length; i++) {		if(".DS_Store" == folderContents[i])			continue;		var isExistItem = false;		for(var j = 0; j < lib.items.length; j++) {			if(lib.items[j].itemType != "bitmap")				continue;			if(lib.items[j].sourceFilePath == FLfile.platformPathToURI(FLfile.uriToPlatformPath(pngPath + "/" + folderContents[i]))) {				isExistItem = true;				doc.library.updateItem(lib.items[j].name);				break;			}		}		if(isExistItem == false) {			doc.editScene(0);			doc.importFile(FLfile.platformPathToURI(FLfile.uriToPlatformPath(pngPath + "/" + folderContents[i])), true);		}	}		fl.saveDocument(fl.getDocumentDOM());	fl.trace("Save Done");	alert("Importing Process Done!!");}main();